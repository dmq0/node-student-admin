<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <title>å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</title>
  <link rel="stylesheet" href="./css/main.css">
  <link rel="stylesheet" href="./fonts/iconfont.css">
  <!-- æ³¨æ„æœ¬é¡¹ç›®åœ¨ä½¿ç”¨æ—¶ï¼Œæ›´æ”¹äº†bootstrapçš„cssæ–‡ä»¶ä¸­çš„æ ·å¼ -->
  <script src="./js/jquery-3.5.1.min.js"></script>
  <link rel="stylesheet" href="./css/bootstrap.min.css">
  <script src="./js/bootstrap.bundle.min.js"></script>
  <script src="./js/message.min.js"></script>
  <script src="./js/shepherd.min.js"></script>
  <script src="./js/jquery.i18n.min.js"></script>
  <link rel="stylesheet" href="./css/shepherd.css">
  <script src="./utils/tail.js"></script>
</head> 
<body>
  <div class="left-flex" id="step7">
    <!-- åŠ¨æ€è·¯ç”±å±•ç¤º -->
    <!-- æ ¹æ®åç«¯è¿”å›çš„æ•°æ® -->
    <ul id="left-span">
      <li class="left-title">
        <img src="./assets/giphy2.gif" class=" translate" alt="">
        <h1><span  i18n="i18n.title">å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</span></h1>
      </li>
      <li id="center" style="display: none;" class="dashboard"><a class="link" href="./html/dashboard.html" target="main"><i class="iconfont icon-user"></i><span style="color: aliceblue;" class="left-font" i18n="i18n.center">ä¸ªäººä¸­å¿ƒ</span></a></li>
      <li id="class" style="display: none;" class="class"><a class="link" href="./html/class.html" target="main"><i class="iconfont icon-weibiaoti--"></i><span class="left-font" i18n="i18n.class">ç­çº§ä¿¡æ¯</span></a></li>
      <li id="limit" style="display: none;" class="limit"><a class="link" href="./html/limit.html" target="main"><i class="iconfont icon-guanliyuan_jiaoseguanli"></i><span class="left-font" i18n="i18n.limit">æƒé™è®¾ç½®</span></a></li>
      <li id="school" style="display: none;" class="school"><a class="link" href="./html/school.html" target="main"><i class="iconfont icon-xuexiao_xuexiaoxinxi
        "></i><span class="left-font" i18n="i18n.school">å­¦æ ¡ä¿¡æ¯</span></a></li>
      <li id="file" style="display: none;" class="file"><a class="link" href="./html/file.html" target="main"><i class="iconfont icon-duowenjianjia"></i><span class="left-font" i18n="i18n.file">æ–‡ä»¶ç®¡ç†</span></a></li>
    </ul>
  </div>
  <div class="top-fixed">
    <div class="top-left" style="position: relative;">
      <i id="step1" class="iconfont icon-jizhanguanli"></i>
      <span i18n="i18n.direction">æŒ‡ç¤ºæ¿</span>
    </div>
    <div class="top-right">
      <i id="step2" class="iconfont icon-chengchangzhiyin" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="æŒ‡å¼•"></i>
      <i id="step3" class="iconfont icon-yuyan" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="æ‹–å°¾"></i>
      <i id="step4" class="iconfont icon-fangda1" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="å…¨å±"></i>
      <i id="step5" class="iconfont icon-pifu1" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="æ¢è‚¤"></i>
      <i id="step6" class="iconfont icon-yuyan1" data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-title="å›½é™…åŒ–"></i>
      <img src="./assets/giphy2.gif" alt="å›¾ç‰‡åŠ è½½å¤±è´¥">
      <ul class="list-group" id="list-group">
        <li class="list-group-item" id="step8"><a href="" i18n="i18n.logout">âœ¡é€€å‡º</a></li>
        <li class="list-group-item" id="step9"><a href="http://xdxc.web3v.vip/" i18n="i18n.more">ğŸš©æ›´å¤š</a></li>
      </ul>
    </div>
  </div>
  <div class="main">
    <iframe id="iframe" src="./html/dashboard.html" name="main" frameborder="0" allowfullscreen></iframe>
  </div>
  <!-- æ¨¡æ€æ¡†é€‰å–ä¸»é¢˜è‰² -->
  <div class="modal fade" id="Modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel" i18n="i18n.selectColor">é€‰å–ä¸»é¢˜è‰²</h5>
          <button type="button" data-toggle="modal" data-target="#myModal" class="close closeModel" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true" class="closeModal">âŒ</span>
          </button>
        </div>
        <div class="modal-body">
         <input type="color" id="colorInput">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary closeModal" data-dismiss="modal" i18n="i18n.noselect">å–æ¶ˆ</button>
          <button type="button" class="btn btn-primary" id="confirm" i18n="i18n.confirm">ç¡®å®š</button>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
      sessionStorage.getItem('token') || location.replace('/pages/login.html')
      $('.link').on('click',function () {
      sessionStorage.getItem('token') || location.reload()
      })
      let permissionArr = JSON.parse(localStorage.getItem('user'))[0].permission.split(',');
      permissionArr.forEach(item => {
        $('#'+item).css('display','block')
      });
      // é€€å‡ºç™»å½•
      $("#step8").on('click',function () {
        location.replace('/pages/login.html')
        sessionStorage.removeItem('token')
      })
      localStorage.getItem('lang') || localStorage.setItem('lang','cn');
      if(localStorage.getItem('lang') == 'cn'){
      $("[data-bs-title]")[0].setAttribute('data-bs-title','æŒ‡å¼•')
      $("[data-bs-title]")[1].setAttribute('data-bs-title','æ‹–å°¾')
      $("[data-bs-title]")[2].setAttribute('data-bs-title','å…¨å±')
      $("[data-bs-title]")[3].setAttribute('data-bs-title','æ¢è‚¤')
      $("[data-bs-title]")[4].setAttribute('data-bs-title','å›½é™…åŒ–')
      }else{
      $("[data-bs-title]")[0].setAttribute('data-bs-title','Guide')
      $("[data-bs-title]")[1].setAttribute('data-bs-title','Tail')
      $("[data-bs-title]")[2].setAttribute('data-bs-title','Full Screen')
      $("[data-bs-title]")[3].setAttribute('data-bs-title','Change Theme')
      $("[data-bs-title]")[4].setAttribute('data-bs-title','International')
      }
      // åˆ›å»ºæ¨¡æ€æ¡†
        $(function () {
        $("#Modal").modal({
        "keyboard":true,
        })
        localStorage.getItem('themeColor') ? $(':root').css('--left-bar-color',localStorage.getItem('themeColor')): localStorage.setItem('themeColor',' #304156');
 // å¯åŠ¨tooltip
 const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
 const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
 // æ§åˆ¶å·¦ä¾§æ å®½åº¦
 let isTranslate = false;
//  ä¸»é¢˜è‰²ç‚¹å‡»äº‹ä»¶
 $("#step5").on('click',function () {
  $('#Modal').modal('show')
  $('#colorInput').val(localStorage.getItem('themeColor') || '#304156')
 })
 $(".closeModal").on('click',function () {
  $("#Modal").modal('hide')
 })
$('#confirm').on('click',function () {
  let color = $('#colorInput').val();
  $('#colorInput').val(color)
  $(':root').css('--left-bar-color', color);
  localStorage.setItem('themeColor',color)
  $("#Modal").modal('hide');
})

 
$("#step1").click(function () {
  if(isTranslate){
    $('#left-span').addClass('translate')
    $('iframe').css({
      width:"calc(100% - 54px)",
      transition: "width 0.8s ease-in-out 0s",
    })
    isTranslate=false
  }else{
    $('#left-span').removeClass('translate')
    $('iframe').css({
      width:"calc(100% - 210px)",
      transition: "width 0.8s ease-in-out 0s",
    })
    isTranslate=true
  }
})
$('#step2').on('click',function () {
  tour.start();
})
    // åˆ›å»ºå¼•å¯¼æ–¹æ³•
    const tour = new Shepherd.Tour({
      useModalOverlay: true,
      defaultStepOptions: {
        classes: 'shadow-md bg-purple-dark',
        scrollTo: true
      }
    });
    let langFlag = (localStorage.getItem('lang')=='cn')
    let i18nClose = langFlag?'å…³é—­':'Close'
    let i18nNext = langFlag?'ä¸‹ä¸€æ­¥':'Next Step'
    function addStep(element,text,position='bottom'){
      tour.addStep({
      id: element,
      text: text,
      attachTo: {
        element: '#'+element,
        on: position
      },
      classes: 'example-step-extra-class',
      buttons: [
        {
          text: i18nClose,
          action: tour.hide
        },
        {
          text: i18nNext,
          action: tour.next
        }
      ]
    });
    }
    addStep('step1',langFlag?'ä¼¸ç¼©ä¾§è¾¹æ ':'Telescopic sidebar')
    addStep('step2',langFlag?'æ–°æ‰‹æŒ‡å¼•':'Novice guide')
    addStep('step3',langFlag?'æ‹–å°¾':'Streaking')
    addStep('step4',langFlag?'å…¨å±':'Full Screen')
    addStep('step5',langFlag?'ä¸»é¢˜è‰²':'Subject color')
    addStep('step6',langFlag?'å›½é™…åŒ–':'Internationalization')
    addStep('step7',langFlag?'ä¾§è¾¹æ ':'Sidebar','right')
    addStep('step8',langFlag?'é€€å‡ºç™»å½•':'Logout')
    addStep('step9',langFlag?'æ›´å¤š':'more')
    $("#step3").on('click',function () {
      localStorage.getItem('tail')?localStorage.removeItem('tail'):localStorage.setItem('tail','tail')
      location.reload()
    })
    if(localStorage.getItem('tail')){
      let startTail = document.addEventListener('mousemove',function (e) {
      let x = e.pageX;
      let y = e.pageY;
      new Ball(x, y);
    }) 
    }else{
      try{
        document.removeEventListener('mousemove',startTail)
      }catch{}
    }
    /*
 * è¿›å…¥å…¨å±
 */
function fullScreen() {
    let el = document.getElementById('iframe') // è·å–éœ€è¦å…¨å±æ˜¾ç¤ºçš„å› ç´ 
    let rfs = el.requestFullScreen
        || el.webkitRequestFullScreen
        || el.mozRequestFullScreen
        || el.msRequestFullScreen
    	// è·å–å®ç°å…¨å±çš„æ–¹æ³•ï¼Œæ­¤å¤„å…¼å®¹äº†ç«ç‹ã€è°·æ­Œã€IEã€safariæµè§ˆå™¨
    if (typeof rfs != "undefined" && rfs) {
        rfs.call(el)
        return
    }
    if (typeof window.ActiveXObject != "undefined") {
        let wscript = new ActiveXObject("WScript.Shell") // å–å¾—ç³»ç»Ÿç›®å½• 
        if (wscript) {
            wscript.SendKeys("{F11}") 
        }
    }
}
       // å…¨å±
       $('#step4').on('click',function () {
         fullScreen()
       })
       // å›½é™…åŒ– 
    $("[i18n]").i18n({
    defaultLang:localStorage.getItem('lang') || "cn",
    filePath: "/i18n/", //æ³¨æ„ï¼è¦é…ç½®å¥½è¯­è¨€æ–‡ä»¶çš„æ­£ç¡®è·¯å¾„
    filePrefix: "i18n_",
    fileSuffix: "",
    forever: true,
    callback: function() {
     
    }
    });
       $('#step6').on('click',function () {
       localStorage.getItem('lang') == 'cn' ?localStorage.setItem('lang','en'):localStorage.setItem('lang','cn'); 
       location.reload()
       })
})
</script>
</html>